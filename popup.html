<style>
body { overflow-x:hidden; }
a { display:block; padding-left:5px; height:24px; line-height:24px; white-space:nowrap; color:black; text-decoration:none; }
a.active { font-weight:bolder; }
a span { margin-left:5px; font-size:12px; vertical-align:middle; line-height:24px; height:24px; }
a img { vertical-align:middle; height:16px; width:16px; padding-top:4px; padding-bottom:4px; }
a:hover { background-color:#dfe6f6; } 
</style>

<script>
  db = new Array;
  tmp = new Object;

  function truncate(str) {
    var MAXCHARS=64;
    if (str && str.length > MAXCHARS) {
      return str.substring(0, MAXCHARS) + '...'
    }else {
      return str;
    }
  }

  function makeEntry(tab) {
    var text = document.createElement('span');
    var link = document.createElement('a');
    var favIcon = new Image();

    var title = truncate(tab.title);
    var url = tab.url;

    favIcon.src = tab.favIconUrl;
    favIcon.alt = 'favIcon'

    text.textContent = title;

    link.setAttribute('href', url);

    link.appendChild(favIcon);
    link.appendChild(text);

    if (active) link.className += ' active'

    return link;
  }


  function getCurrentTab() { chrome.tabs.getSelected(undefined, function f(tab) { tmp = tab; }); return tmp; }

  chrome.tabs.getAllInWindow(null, function f(tabs) {

    for(var i=0;i<tabs.length;i++) {

      var box = document.getElementById('content');
      box.appendChild(makeEntry(tabs[i]));
      //, (tabs[i] == getCurrentTab()) );

    }
  });

</script>
<body>
  <div id="content">
  </div>
</body>

